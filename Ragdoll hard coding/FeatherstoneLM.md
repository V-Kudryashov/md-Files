Алгоритм Обратной Динамики — **Рекурсивный Метод Ньютона-Эйлера (Recursive Newton-Euler Method, RNE)** — подробно описан в Главе 4 источника. Этот метод является самым эффективным из известных на сегодняшний день для вычисления обратной динамики роботов с открытой кинематической цепью.

Задача обратной динамики состоит в нахождении **усилий в шарнирах** ($Q_i$), необходимых для достижения заданных **ускорений в шарнирах** ($\ddot{q}_i$). RNE использует **рекуррентные соотношения** для достижения вычислительной сложности $O(n)$, что значительно быстрее, чем нерекурсивные подходы.

### Модель Роботизированной Системы (Система Координат)

Алгоритм применяется к модели робота, представляющей собой одиночную **нерасчлененную (un-branched) открытую кинематическую цепь**.

1.  Робот состоит из $n$ подвижных звеньев (1..n) и $n$ шарниров (1..n).
2.  Шарнир $i$ соединяет звено $i$ со звеном $i-1$. Звено 0 — неподвижное основание.
3.  Для каждого звена $i$ определены его пространственная инерция $\hat{I}_i$ и вектор оси шарнира $\hat{s}_i$, обычно выраженные в его собственных $i$-координатах.
4.  Векторы скорости $\dot{q}$ и ускорения $\ddot{q}$ шарниров считаются **известными**.

### Формулировка Рекурсивного Метода Ньютона-Эйлера

RNE-алгоритм выполняется в три основных этапа.

#### Шаг 1: Расчет движения звеньев (Link Motion)

На этом этапе вычисляются абсолютные пространственные скорости ($\hat{v}_i$) и ускорения ($\hat{a}_i$) каждого звена, начиная с неподвижного основания (звено 0) и двигаясь вперед к концевому захвату (звено $n$).

**1.1. Рекуррентное соотношение для скорости** (Forward iteration: Base $\to$ End-effector):

Абсолютная скорость звена $i$ определяется скоростью предыдущего звена ($i-1$) и относительной пространственной скоростью в шарнире $i$ ($\hat{s}_i \dot{q}_i$):

$$\hat{v}_i = \hat{v}_{i-1} + \hat{s}_i \dot{q}_i \quad (\hat{v}_0 = 0)$$

**1.2. Рекуррентное соотношение для ускорения** (Forward iteration: Base $\to$ End-effector):

Абсолютное ускорение звена $i$ включает ускорение предыдущего звена, заданное шарнирное ускорение ($\hat{s}_i \ddot{q}_i$) и член, учитывающий эффект Кориолиса/центробежных сил ($\hat{v}_i \times \hat{s}_i \dot{q}_i$):

$$\hat{a}_i = \hat{a}_{i-1} + \hat{v}_i \times \hat{s}_i \dot{q}_i + \hat{s}_i \ddot{q}_i \quad (\hat{a}_0 = 0)$$

**Примечание о гравитации:** Сила тяжести может быть учтена эффективно путем задания фиктивного начального ускорения основания $\hat{a}_0 = -\mathbf{g}$, где $\mathbf{g}$ — вектор гравитационного ускорения.

#### Шаг 2: Расчет чистых сил, действующих на звенья (Net Forces on the Links)

Для каждого звена $i$ вычисляется **суммарная пространственная сила** ($\hat{f}_i$), которая требуется для сообщения ему рассчитанного движения. Эта сила равна скорости изменения пространственного импульса звена:

$$\hat{f}_i = \hat{I}_i \hat{a}_i + \hat{v}_i \times \hat{I}_i \hat{v}_i$$

В этой формуле $\hat{I}_i \hat{a}_i$ представляет инерционные силы/моменты, а $\hat{v}_i \times \hat{I}_i \hat{v}_i$ — центробежные и кориолисовы силы/моменты (скоростные члены).

#### Шаг 3: Расчет сил в шарнирах (Joint Forces)

На этом этапе алгоритм выполняется в обратном направлении, начиная от концевого захвата и двигаясь к основанию (Backward iteration: End-effector $\to$ Base).

**3.1. Рекуррентное соотношение для передаваемой силы** (Total transmitted force):

Вычисляется полная сила, передаваемая от звена $i-1$ к звену $i$ через шарнир $i$. Она должна уравновешивать чистую силу, действующую на звено $i$ ($\hat{f}_i$), и сумму сил, передаваемых всем последующим звеньям ($\hat{f}_{i+1}$):

$$\hat{f}_i = \hat{f}_{i+1} + \hat{f}_i$$

(Начальное условие: $\hat{f}_{n+1}$ — любая заданная внешняя сила, действующая на концевой захват, или $\hat{f}_{n+1} = \mathbf{0}$).

**3.2. Расчет скалярной силы в шарнире:**

Искомая скалярная сила в шарнире $Q_i$ находится путем проецирования вектора полной передаваемой силы ($\hat{f}_i$) на ось шарнира $\hat{s}_i$ с помощью пространственного скалярного произведения:

$$Q_i = \hat{s}_i^S \hat{f}_i$$

### Повышение Эффективности в Координатах Звеньев

Хотя вышеприведенные формулы используют абсолютные координаты, для достижения максимальной вычислительной эффективности RNE-алгоритм часто реализуется в **координатах звеньев** (Link Coordinates).

Такая формулировка требует преобразования только векторов (скоростей, ускорений, сил) между соседними системами координат, а не тензоров, что значительно ускоряет вычисления.

В целом, для робота с $n$ степенями свободы RNE-алгоритм требует $O(n)$ вычислительных операций.
